- if @user_name
  %div
    %label.checkbox
      %input{:type => "checkbox", :'ng-model' => "oneAtATime"} Open only one at a time
    %accordion{:'close-others' => "oneAtATime"}
      - Room.all.each do |room|
        - if Storage::readable? @user_name, room.id
          - msgs = Storage::messages.where(:room => room.jid)
          %accordion-group
            %accordion-heading
              = "#{room.jid}"
              %span.badge.pull-right= "#{msgs.count}"
            %ul
              - msgs.each do |m|
                %li= "[#{m[:mtime]}] #{m[:from]}: #{m[:text]}"
